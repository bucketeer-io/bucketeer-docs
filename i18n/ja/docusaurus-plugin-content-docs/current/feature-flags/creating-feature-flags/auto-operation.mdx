---
title: 自動オペレーション
# sidebar_position:
slug: /feature-flags/creating-feature-flags/auto-operation
description: The Auto Operation feature handles the manipulation of feature flag configurations on your behalf. It executes specific operations automatically based on the conditions set by the user.
tags: ['guide', 'automation', 'operation', 'feature-flag']
---

import CenteredImg from '@site/src/components/centered-img/CenteredImg';

自動オペレーション機能は、フィーチャーフラグ構成のオペレーションをユーザーに代わって処理します。ユーザーが設定した条件に基づいて、特定のオペレーションを自動的に実行します。

Bucketeerダッシュボードの自動オペレーションページにアクセスするには、**フィーチャーフラグ**タブを選択して目的のフラグを選択し、その名前をクリックします。新しいページの上部にある**自動オペレーションルール**タブを選択します。自動オペレーションルールページでは、アクティブなオペレーションと完了したオペレーションを確認できます。

## 自動オペレーションの仕組み

自動オペレーション機能は、2つの重要な要素で構成されています：

- **オペレーション**: オペレーションは、フィーチャーフラグに影響を与えるアクションを意味します。各アクションは、1つ以上のトリガー条件に関連付けられています。条件が満たされると、関連付けられたオペレーションのアクションが実行されます。現在、Bucketeer は次の 2 種類のオペレーションをサポートしています：

  - **有効**: このオペレーションタイプは、選択されたフラグを有効にします。
  - **キルスイッチ**: このオペレーションタイプは、選択されたフラグを無効にします。

- **条件**: 条件は、オペレーションがトリガーされる状況を指定します。複数の条件を 1 つのキルオペレーションに関連付けることができますが、有効化オペレーションには 1 つの条件しか関連付けることができません。重要なのは、いずれかの条件が満たされると対応するオペレーションがトリガーされることです。

自動オペレーションは、オペレーションと条件に基づいて以下のように動作します：

1. サーバは指定された条件を監視します。
2. 条件が満たされると、対応するオペレーションが実行されます。
3. 関連するフラグを有効または無効にした後、トリガーされたオペレーションの状態はアクティブから完了に変わります。
4. オペレーションはアクティブパネルから完了パネルに移動され、実行済みであることが示されます。

## 条件

自動オペレーションの定義には以下の条件があります：

1. **スケジュール**: この条件は、指定された日付と時間に達したかどうかを評価します。オペレーションをスケジュールするには、常に将来の日付と時間を使用する必要があります。例えば、特定の日付と時間に機能をリリースしたり、一定期間後にベータ機能をオフにするために使用できます。

<CenteredImg
  imgURL="img/feature-flags/auto-ops-rules/schedule-condition-v2.png"
  alt="Event rate panel"
  wSize="400px"
  borderWidth="1px"
/>

:::info スケジュール条件の制限

スケジュール条件に基づいたアクティブなオペレーションは 2 つのみです。1 つはフラグを有効にするタイミングを定義し、もう 1 つはフラグを無効にするタイミングを定義します。

:::

2. **イベント率**: この条件は、イベント率が指定されたしきい値に達するとオペレーションをトリガーします。イベント率は、キルオペレーションにのみ使用できます。これにより、エラー率が高い場合にフラグを自動的にオフにしたり、分析に必要なデータが十分に収集されたらフラグをオフにしたりすることができます。

<CenteredImg
  imgURL="img/feature-flags/auto-ops-rules/event-rate-condition-v2.png"
  alt="Event rate panel"
  wSize="400px"
  borderWidth="1px"
/>

以下は、イベント率条件の設定オプションに関する説明です：

- **バリエーション**: ターゲットユーザーが観察した特定のバリエーション。
- **ゴール**: イベント率の計算に使用されるゴールを指します。ゴールに到達するたびに、ゴールイベントのカウンタが増加します
- **条件**: イベントレートを評価するために使用する比較演算子を指します。使用できるオプションは、以上または等しい（>=）もしくは以下または等しい（<=）です。
- **パーセンテージ**: イベント率のしきい値を指します。
- **最小回数**: 条件を有効にするために必要な発生回数の最小値。

## イベント率の計算方法

イベント率は以下の式で計算されます：

**イベント率 = (ゴールイベントのユニークカウンター) / (評価イベントのユニークカウンター)**

ゴールおよび評価のユーザーカウントをよりよく理解するために、[エクスペリメント](/feature-flags/testing-with-flags/experiments)と[結果の評価](/feature-flags/creating-feature-flags/evaluate-results)のセクションをご参照ください。


## 自動オペレーションの設定

自動オペレーションの設定は簡単です。以下のステップに従ってください：

1. 自動オペレーションルールのページに移動します。
2. **オペレーションの追加**ボタンをクリックします。
3. オペレーション設定パネルが表示されます。目的のオペレーションを選択します。この例では、**有効**オプションが選択されています。
4. 目的の条件を設定します。**有効**オペレーションの場合は、**スケジュール**のみ使用できます。
5. **オペレーションの作成**ボタンをクリックして、自動オペレーションルールを作成します。以下の画像は、前のステップで説明した設定をまとめたものです。


<CenteredImg
  imgURL="img/feature-flags/auto-ops-rules/create-operation.png"
  alt="Event rate panel"
  wSize="400px"
  borderWidth="1px"
/>

予定時刻になると、自動的にフィーチャーフラグが有効になります。
