---
title: イベント率
slug: /feature-flags/creating-feature-flags/auto-operation/event-rate
description: Bucketeer でのイベントレート機能の動作を確認してください
tags:
  - guide
  - automation
  - event rate
  - feature-flag
---

import CenteredImg from '@site/src/components/centered-img/CenteredImg';

イベントレート条件は、使用率に基づいてフラグをオフにするように設計されています。 これらの条件の一般的な使用例は次のとおりです。

-   高いエラー率を引き起こすフラグを自動的に消去します。
-   分析のためにデータを収集するために使用するフラグをオフにします。 したがって、十分なデータが収集されると、イベントレートの状態がフラグをオフにすることができます。
-   一定回数訪れたフラグを無効にします。 ユーザーがフラグを訪れるたびに、そのイベントを送信できます。 それがしきい値に達したときにシステムを止めることができます

## イベントレートの仕組み

イベントレート条件は、特定のイベントの頻度が特定のしきい値に達すると操作をトリガーします。 たとえば、ユーザーがフラグを訪れるたびに、SDK経由でイベントを送信して、その訪問を追跡できます。 Bucketeer システムは、これらのイベントを受信し、各フラグのバリエーションの頻度を追跡します。 したがって、システムはイベントレートを評価し、特定のフラグをオフにする必要があるかどうかを判断できます。

イベントレート条件を設定するには、次の構成を定義する必要があります。

-   **バリエーション**: ターゲットユーザーが観察した特定のバリエーション。 イベントレートは、このバリエーションを使用して呼び出されるイベントを使用して計算されます。
-   **ゴール**: イベント率の計算に使用されるゴールを指します。 ゴールに到達する度にゴールイベントのカウンターが増えます。
-   **条件**: イベントレートを評価するために使用する比較演算子を指します。使用できるオプションは、以上または等しい（>=）もしくは以下または等しい（\<=）です。 使用可能なオプションは(>=) 以上または(\<=) 以下です。 
-   **パーセンテージ**: イベント率のしきい値を指します。
-   **最小回数**: 条件を有効にするために必要な発生回数の最小値。 このオプションを使用すると、一定数のイベントが発生する前にイベントレートがトリガーされず、誤検知を回避できます。

## イベント率の計算方法

Bucketeer システムは、イベントレートを計算するために次の数式を使用します:

**イベント率 = (ゴールイベントのユニークカウンター) / (評価イベントのユニークカウンター)**

ゴールおよび評価のユーザーカウントをよりよく理解するために、[エクスペリメント](/feature-flags/testing-with-flags/experiments)と[結果の評価](/feature-flags/creating-feature-flags/evaluate-results)のセクションをご参照ください。

## イベントレートで自動操作を設定する

イベントレートの条件をフィーチャーフラグに追加するには、以下の手順に従う必要があります。

1.  **自動操作** ページに移動します。
2.  "参加"ボタンを押下します。
3.  オペレーション設定パネルが表示されます。 **キルスイッチ** オプションを選択します。
4.  **イベントレート**を選択します。
5.  条件を設定します。 バリエーション、目標、状態、しきい値、最小カウントを定義します。
6.  **提出**をクリックします。 

以下の画像は、正しい統合の例を示しています。 現在の設定の目的は、エラー率が5%を超える場合にフィーチャーフラグをオフにすることです。 誤解を招くターンオフを避けるために、500の最小カウントが使用されます。

<CenteredImg
  imgURL="img/feature-flags/auto-ops-rules/event-rate-condition-v3.png"
  alt="Create event rate condition"
  wSize="400px"
  borderWidth="1px"
/>
